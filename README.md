# 小红书笔记处理工具

一个用于小红书笔记数据处理的Python工具集。包含笔记内容抓取和标题关键词分析功能，可以批量处理笔记数据并生成分析报告。

## 功能特点

### 笔记内容抓取
- 批量处理小红书笔记URL
- 自动提取笔记详情内容
- 自动提取笔记话题标签
- 支持Excel文件读写
- 完整的错误处理机制
- 详细的日志记录
- 内置请求延时保护

### 标题关键词分析
- 自动提取标题关键词
- 统计关键词出现频次
- 关联原始标题内容
- 按频次降序排序
- 支持自定义停用词
- 智能中文分词处理

### 封面图片下载
- 按条件筛选数据
- 自动下载封面图片
- 智能文件名处理
- 下载进度显示
- 详细统计信息
- 失败重试机制

### 话题统计分析
- 自动提取话题标签
- 智能话题分割
- 频次统计排序
- Top50话题输出
- 格式化结果展示
- 完整统计信息

## 环境要求

- Python 3.6+
- pandas
- requests
- beautifulsoup4
- openpyxl
- jieba

## 安装步骤

1. 克隆项目到本地：
```bash
git clone [项目地址]
```

2. 安装依赖包：
```bash
pip install pandas requests beautifulsoup4 openpyxl jieba
```

## 使用说明

### 笔记内容抓取(xiaohongshu_processor.py)

1. 获取Cookie
   - 获取小红书Cookie步骤：
     - 使用Chrome浏览器打开小红书网页版(https://www.xiaohongshu.com)
     - 登录您的小红书账号
     - 按F12打开开发者工具(Mac用户按Command+Option+I)
     - 切换到"Network"(网络)标签页
     - 刷新页面
     - 在Network面板中找到www.xiaohongshu.com的请求
     - 在右侧Headers(标头)中找到"Request Headers"(请求标头)
     - 找到"Cookie"字段并复制完整内容
   - Cookie使用注意事项：
     - Cookie通常包含多个键值对，需要完整复制
     - Cookie有效期通常为几天到几周不等
     - 如遇到请求失败，请及时更新Cookie
     - 建议定期检查Cookie有效性

2. 配置文件路径
   - 打开 `xiaohongshu_processor.py`
   - 修改 `EXCEL_PATH` 为输入Excel文件的路径
   - 修改 `OUTPUT_PATH` 为输出Excel文件的路径

3. 配置请求头
   - 在 `HEADERS` ��填入有效的Cookie
   - 根据需要修改User-Agent

4. 准备输入文件
   - Excel文件第一行为标题
   - 第一列为小红书笔记URL

5. 运行程序
```bash
python xiaohongshu_processor.py
```

### 标题关键词分析(title_analysis.py)

1. 准备数据
   - 确保输入Excel文件中包含"笔记标题"列
   - 修改INPUT_FILE变量为实际的输入文件路径
   - 修改OUTPUT_FILE变量为期望的输出文件路径

2. 自定义配置（可选）
   - 在STOP_WORDS中添加或删除停用词
   - 使用jieba.add_word()添加自定义词典

3. 运行分析
```bash
python title_analysis.py
```

### 封面图片下载(image_downloader.py)

1. 准备数据
   - 确保Excel文件包含"粉丝数"、"互动量"、"封面地址"列
   - 修改INPUT_FILE变量为实际的输入文件路径
   - 修改OUTPUT_DIR变量为期望的输出目录

2. 运行下载
```bash
python image_downloader.py
```

3. 输出说明
   - 图片将保存在指定目录中
   - 文件名自动处理重复
   - 日志显示下载进度和结果

### 话题统计分析(topic_analyzer.py)

1. 准备数据
   - 确保Excel文件包含"话题标签"列
   - 修改INPUT_FILE变量为实际的输入文件路径
   - 修改OUTPUT_DIR变量为期望的输出目录

2. 运行分析
```bash
python topic_analyzer.py
```

3. 输出说明
   - 结果将保存为txt文件
   - 包含话题排名和出现次数
   - 按出现频次降序排列

## 输出结果

### 笔记内容抓取结果
程序将在输出Excel文件中添加两列：
- `笔记详情`：包含笔记的详细内容
- `笔记话题`：包含笔记的所有话题标签（以逗号分隔）

### 标题关键词分析结果
程序将生成包含以下列的Excel文件：
- `关键词`：提取的标题关键词
- `出现次数`：该关键词在所有标题中出现的次数
- `相关标题`：包含该关键词的原始标题列表（换行分隔）

### 封面图片下载结果
- 符合条件的图片将下载到指定目录
- 保持原始图片格式
- 自动处理重名文件
- 提供下载统计信息

### 话题统计分析结果
- 生成Top50话题统计文件
- 显示每个话题出现次数
- 提供完整排名信息
- 格式化的文本展示

## 常见问题

1. 如果遇到请求失败，请检查：
   - Cookie是否有效
   - 网络连接是否正常
   - 请求频率是否过高

2. 如果数据为空，请确认：
   - URL是否有效
   - 页面结构是否变化
   - 是否有访问权限

3. 如果程序报错，请查看：
   - 日志文件内容
   - Excel文件格式
   - Python环境配置

4. 如果标题分析结果不理想，请尝试：
   - 调整停用词列表
   - 添加自定义词典
   - 检查标题数据格式

5. 如果图片下载失败，请检查：
   - 图片URL是否有效
   - 网络连接是否正常
   - 磁盘空间是否充足

6. 如果话题统计结果异常，请检查：
   - 话题标签格式是否正确
   - 分隔符是否为中文逗号
   - 文件编码是否正确